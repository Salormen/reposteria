<div ng-controller="TournamentController">
    <div id="header">
        <section ng-include="'scripts/vistas/realizacion_torneo/header/title.html'"></section>  
        <section ng-include="'scripts/vistas/realizacion_torneo/header/menu.html'"></section>  
    </div>
    
    <div id="contents" ng-show="!configurando">        
            <!-- Realizacion del torneo-->
            <div id="tournament" >
                <div id="content_frame">
                    
                    <!-- Inscripcion -->
                    <div id="inscripcion_frame" data-ng-show="seSeleccionoFrame('inscripcion', frames)">
                        <div class="col-md-6">
                            <div class="col-md-6"> 
                                <input type="file" id="excel_file"> </input>
                            </div>
                            <div class="col-md-6">
                                <button type="button" ng-click="load_previous_players()">Cargar jugadores</button>
                            </div>
                            <div>
                                <a class="btn" ng-click="agregarTodos()">All</a>
                                <div>
                                    <div class="col-md-3">Filtrar:</div>
                                    <div class="col-md-6">
                                        <input type="text" ng-model="searchedPlayer.nombre" placeholder="Nombre"></input></div>
                                    <div class="col-md-3">
                                        <input type="text" ng-model="searchedPlayer.club" placeholder="Club"></input></div>
                                </div>
                                <table class="table table-condensed">
                                    <thead>
                                        <tr>
                                            <th> Rating </th>
                                            <th> Nombre del jugador </th>
                                            <th> Club </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="jugador in jugadores_previos | orderBy:'parseInt(rating)':true | filter:searchedPlayer"
                                            id="{{jugador.rating + jugador.nombre + jugador.club}}">
                                            <td> {{jugador.rating}}</td>
                                            <td> {{jugador.nombre}}</td>
                                            <td> {{jugador.club}}</td>
                                            <td> <button type="button" ng-click="inscribirJugador(jugador)">+</button> </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <div>
                                    <a class="btn" data-toggle="collapse" href="#newPlayer" aria-expanded="false" > Agregar nuevo jugador </a>  
                                    
                                    <div class="md-inline-form collapse" id="newPlayer">
                                        <md-content layout-gt-sm="row" layout-padding>
                                            <div>
                                              <md-input-container>
                                                <label>Nombre</label>
                                                <input ng-model="nuevo_jugador.nombre" placeholder="Nombre del jugador">
                                              </md-input-container>

                                              <md-input-container>
                                                <label>Club</label>
                                                <input ng-model="nuevo_jugador.club" placeholder="Club del jugador">
                                              </md-input-container>

                                              <md-input-container>
                                                <label>Rating</label>
                                                <input ng-model="nuevo_jugador.rating" placeholder="Rating del jugador">
                                              </md-input-container>
                                              <button type="button" ng-click="agregarNuevoJugador()">
                                                  Agregar jugador
                                              </button> 
                                            </div>
                                      </md-content>
                                    </div>   
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div>
                                Jugadores inscriptos:   <br>
                                <div>
                                    <div class="col-md-3">Filtrar:</div>
                                    <div class="col-md-6">
                                        <input type="text" ng-model="searchedInscriptedPlayer.nombre" placeholder="Nombre"></div>
                                    <div class="col-md-3">
                                        <input type="text" ng-model="searchedInscriptedPlayer.club" placeholder="Club"></div>
                                </div>
                                <table class="table table-condensed">
                                    <thead>
                                        <tr>
                                            <th> Rating </th>
                                            <th> Nombre del jugador </th>
                                            <th> Club </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="jugador in torneo.players | orderBy:'parseInt(rating)':true | filter:searchedInscriptedPlayer">
                                            <td> {{jugador.rating}}</td>
                                            <td> {{jugador.nombre}}</td>
                                            <td> {{jugador.club}}</td>
                                            <td> <button type="button" ng-click="eliminarJugador(jugador, torneo.players)"> X</button> </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <button type="button" ng-click="seed_tournament()">
                                      Sortear!
                                  </button> 
                            </div>
                        </div>                    
                    </div>

                    
                    <!-- Grupos-->
                    <div id="grupos_frame" data-ng-show="seSeleccionoFrame('grupos', frames)">
                        <div id="detalle_grupos" class="col-md-10">
                            <div data-ng-show="seSelecciono_todosLosGrupos">
                                <div ng-repeat="group in torneo.groups | orderBy: 'id'">
                                    Grupo {{other_functions.format_group_id(group.id)}}: <br>
                                    <table class="table table-condensed">
                                        <thead>
                                            <tr>
                                                <th>Rating</th>
                                                <th>Jugador</th>
                                                <th>Club</th>
                                                <th ng-repeat="jugador in group.players | orderBy:'rating':true ">{{jugador.nombre}}</th>
                                                <th>Ptds G/P</th>
                                                <th>Sets G/P</th>
                                                <th>Pts G/P</th>
                                                <th>Pos</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="jugador in group.players | orderBy:'rating':true ">
                                                <td align="left">{{jugador.rating}}</td>
                                                <td align="left">{{jugador.nombre}}</td>
                                                <td align="left">{{jugador.club}}</td>
                                                <td align="left" ng-repeat="jOp in group.players | orderBy:'rating':true ">{{resultadoEnGrupoDeContra(group, jugador, jOp)}}</td>
                                                <td align="left">{{difPartidosGanadosPerdidosEnGrupo(group, jugador)}}</td>
                                                <td align="left">{{difSetsGanadosPerdidosEnGrupo(group, jugador)}}</td>
                                                <td align="left">{{difPuntosGanadosPerdidosEnGrupo(group, jugador)}}</td>
                                                <td align="left">{{posicionEnGrupo(group, jugador)}}</td>
                                            </tr>
                                        </tbody>
                                    </table>                  
                                </div>
                            </div>
                            <div ng-repeat="group in torneo.groups">
                                <div data-ng-show="seSelecciono_grupo(group.id)">
                                    Grupo {{other_functions.format_group_id(group.id)}}: <br>
                                    <table class="table table-condensed">
                                        <thead>
                                            <tr>
                                                <th>Rating</th>
                                                <th>Jugador</th>
                                                <th>Club</th>
                                                <th ng-repeat="jugador in group.players | orderBy:'rating':true ">{{jugador.nombre}}</th>
                                                <th>Ptds G/P</th>
                                                <th>Sets G/P</th>
                                                <th>Pts G/P</th>
                                                <th>Pos</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="jugador in group.players | orderBy:'rating':true ">
                                                <td align="left">{{jugador.rating}}</td>
                                                <td align="left">{{jugador.nombre}}</td>
                                                <td align="left">{{jugador.club}}</td>
                                                <td align="left" ng-repeat="jOp in group.players | orderBy:'rating':true ">{{resultadoEnGrupoDeContra(group, jugador, jOp)}}</td>
                                                <td align="left">{{difPartidosGanadosPerdidosEnGrupo(group, jugador)}}</td>
                                                <td align="left">{{difSetsGanadosPerdidosEnGrupo(group, jugador)}}</td>
                                                <td align="left">{{difPuntosGanadosPerdidosEnGrupo(group, jugador)}}</td>
                                                <td align="left">{{posicionEnGrupo(group, jugador)}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <button ng-click="editar_grupo(group.id)">
                                        Editar
                                    </button> 
                                    <button ng-click="print_group(group)">
                                        Imprimir
                                    </button>
                                    <button ng-click="group.finished = true">
                                        Cerrar grupo
                                    </button>
                                    <div ng-show="group.finished"> Grupo cerrado </div>
                                    <div data-ng-show="editando_grupo(group.id)">
                                        <div ng-repeat="partido in grupo.partidos">
                                            <table class="table table-condensed">
                                                Partido {{partidos.indexOf(partido) + 1}}
                                                <thead>
                                                    <tr>
                                                        <th> Jugadores </th>
                                                        <th ng-repeat="set in partido.sets"> Set {{partido.sets.indexOf(set) + 1}} </th>
                                                        <th> Resultado final </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td> {{partido.jugador1.nombre}} </td>
                                                        <td ng-repeat="set in partido.sets"> <input ng-model="set[partido.jugador1.id]" placeholder="0" size="4"> </td>
                                                        <td> <input ng-model="partido.final[partido.jugador1.id]" placeholder="0" size="4"></td>
                                                    </tr>
                                                    <tr>
                                                        <td> {{partido.jugador2.nombre}} </td>
                                                        <td ng-repeat="set in partido.sets"> <input ng-model="set[partido.jugador2.id]" placeholder="0" size="4"> </td>
                                                        <td> <input ng-model="partido.final[partido.jugador2.id]" placeholder="0" size="4"></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>                             
                        </div>                    
                    </div>

                    <!-- Llave-->
                    <div id="llave_frame" data-ng-show="seSeleccionoFrame('llave', frames)">
                        <div data-ng-show="seeded">
                            <div ng-show="any_bracket_is_selected">
                                <div>
                                    <a class="btn" ng-click="print_matches()"> Imprimir partidos ({{matches_for_print.length}}/4) </a> 
                                </div>
                                <div data-ng-repeat="match in bracket_funcs.round_n(torneo.brackets[selected_bracket],selected_round)">
                                    Partido {{match.id}}
                                    <div ng-show="!match.is_bye_match">
                                        <table class="table table-condensed">
                                            <thead>
                                                <tr>
                                                    <th> Jugadores </th>
                                                    <th ng-repeat="set in match.sets"> Set {{match.sets.indexOf(set) + 1}} </th>
                                                    <th> Resultado final </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr id='{{selected_bracket + selected_round + match.players[0].rating + match.players[0].nombre + match.players[0].club}}'>
                                                    <td> {{match.player(0).nombre}} </td>
                                                    <td ng-repeat="set in match.sets"> <input ng-model="set[0]" placeholder="0" size="4"> </td>
                                                    <td> <input ng-model="match.final[0]" placeholder="0" size="4"></td>
                                                </tr>
                                                <tr id='{{selected_bracket + selected_round + match.players[1].rating + match.players[1].nombre + match.players[1].club}}'>
                                                    <td> {{match.player(1).nombre}} </td>
                                                    <td ng-repeat="set in match.sets"> <input ng-model="set[1]" placeholder="0" size="4"> </td>
                                                    <td> <input ng-model="match.final[1]" placeholder="0" size="4"></td>
                                                </tr>
                                            </tbody>
                                        </table> 
                                    </div>
                                    <div ng-show="match.is_bye_match">
                                        <table class="table table-condensed">
                                            <thead>
                                                <tr>
                                                    <th> Jugadores </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td> {{match.player(0).nombre}} </td>
                                                </tr>
                                                <tr>
                                                    <td> {{match.player(1).nombre}} </td>
                                                </tr>
                                            </tbody>
                                        </table> 
                                    </div>
                                    <a class="btn" ng-click="print_match(match)"> Agregar a impresión </a>  
                                </div>  
                            </div>
                        </div>
                        
                    </div>
                    
                    <!-- Resultados -->
                    <div id="resultados_frame" data-ng-show="seSeleccionoFrame('resultados', frames)">
                        
                    </div>
                    
                </div>
            </div>
        </div>
</div>